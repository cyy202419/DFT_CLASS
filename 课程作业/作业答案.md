\end{array} $$

### 5. 在 Hartree-Fock 近似下，说明关联能的来源及其定义，说明关联能不会大于零，并列举解决电子关联问题的常用方法
$$\text{关联：电子波函数不能写成单粒子波函数乘积形式，        }
\Phi(r_{1},r_{2}, \ldots,r_{n}) \neq \varphi_{1}(r_{1}) \varphi_{2}(r_{2}) \ldots \varphi_{n}(r_{n})
$$
### 6. 利用变分原理推导 Hartree-Fock 方法交换积分的变分导数。
$$
\begin{array}
\delta \frac{1}{2} \sum_{i,j}k_{ij}= \delta \frac{1}{2} \sum_{i,j} \int \phi_{i}^{*}(r_{1}) \phi_{j}^{*}(r_{2}) \frac{1}{|r_{1}-r_{2}|} \phi_{i}(r_{2}) \phi_{j}(r_{1})dr_{1}dr_{2}\newline = \sum_{j} \int \delta \phi_{a}^{*}(r_{1}) \phi_{j}^{*}(r_{2}) \frac{1}{|r_{1}-r_{2}|} \phi_{a}(r_{1}) \phi_{j}(r_{1})dr_{1}dr_{2} \\
\frac{ \delta \frac{1}{2} \sum_{ij}k_{ij}}{ \delta \phi_{a}^{*}}= \sum_{j} \phi_{j}(r_{1}) \int \phi_{j}^{*}(r_{2}) \frac{1}{|r_{1}-r_{2}|} \phi_{a}(r_{2})dr_{2}
\end{array}
$$
### 10. 以氢原子为例，根据量子力学求解出来的波函数，计算其在 LDA 下的动能、外势场能、库伦能、交换能和关联能（PW92）
#### 交换能
$$
\begin{array}{l}
\Phi= \frac{1}{ \sqrt{ \pi}}e^{-r}, \rho= \frac{1}{ \pi}e^{-2r} \\
E_{x}= \int \rho \epsilon_{x}(p)dr\\ \epsilon_{x}= \epsilon^{0}(n)+[ \epsilon^{1}(n)- \epsilon^{0}(n)]f( \zeta) \\
\text{对于氢原子，} \zeta=0,f (\zeta)=0 \\
\epsilon_{x}= \epsilon^{0} \left( n \right)=- \frac{3}{4} \left( \frac{9}{4 \pi^{2}} \right)^{1/3} \frac{1}{r_{s}}=- \frac{3}{4} \left( \frac{9}{4 \pi^{2}} \right)^{1/3} \frac{1}{ \left( \frac{3}{4 \pi \rho} \right)^{1/3}}=- \frac{3}{4}( \frac{3\rho}{ \pi})^{1/3} \\
E_{x}= \int \rho \left(- \frac{3}{4} \right) \left( \frac{3\rho}{ \pi} \right)^{1/3}dr\newline \qquad=-3 \left( \frac{3}{ \pi^{2}} \right)^{ \frac{1}{3}} \int r^{2}e^{- \frac{8}{3}r}dr=-0.2127
\end{array}
$$
#### 关联能
$$
\begin{array}{l}
E_{c}=4 \pi \int \rho \epsilon_{c}(p)r^{2}dr \newline
\epsilon^{0}(p)=-2A(1+ \alpha_{1}r_{s}) \ln \Big(1+ \frac{1}{2A( \beta_{1}r_{s}^{1/2}+ \beta_{2}r_{s}+ \beta_{3}r_{s}^{3/2}+ \beta_{4}r_{s}^{2})} \Big) \\
A=0.031091, \alpha_{1}=0.2137, \beta_{1}=7.5957,\newline \beta_{2}=3.5876, \beta_{3}=1.6382, \beta_{4}=0.49294 \\
E_{c}=-0.044
\end{array}
$$

```python
import numpy as np
from scipy.integrate import quad

def rho(r):
    return (1/np.pi) * np.exp(-2 * r)

def r_s(r):
    # 限制r的值以避免溢出
    r = np.minimum(r, 20)  # 你可以根据需要调整这个值
    return (3/4) ** (1/3) * np.exp(2*r/3)

def epsilon_c(r):
    rs = r_s(r)
    x = np.sqrt(rs)
    
    A = 0.031091
    alpha1 = 0.2137
    beta1 = 7.5957
    beta2 = 3.5876
    beta3 = 1.6382
    beta4 = 0.49294
    
    # 确保对数函数的参数为正且不会太小
    term = 1 + 1/(2*A * (beta1*x + beta2*x**2 + beta3*x**3 + beta4*x**4))
    if term <= 1:
        term = 1 + 1e-12 # 添加一个小的正数以避免对数为负或零
    
    ep = -2*A * (1 + alpha1*x**2) * np.log(term)
    return ep

def integrand(r):
    ep = epsilon_c(r)
    rho_val = rho(r)
    if np.isfinite(ep) and np.isfinite(rho_val):
        return ep * rho_val * 4 * np.pi * r**2
    else:
        return 0  # 如果epsilon_c或rho不是有限值，则返回0

E_c, error = quad(integrand, 0, np.inf, epsabs=1e-12, epsrel=1e-12)

print(f'关联能 E_c = {E_c}')
```
#### 库伦能
$$
\begin{array}{l}
E_{cl}= \frac{1}{2} \iint \frac{\rho(r^{ \prime})\rho(r)}{|r-r^{ \prime}|}drdr^{ \prime} \\
|r-r^{ \prime}|= \sqrt{r^{2}+r^{\prime 2} -2rr^{ \prime} \cos \theta} \\
E_{cl}= \frac{1}{2} \int dr \rho(r) \int \frac{p(r^{ \prime})dr^{ \prime}}{|r-r^{ \prime}|} \\
\end{array}
$$
$$
\begin{array}{l}
\int \frac{ \rho(r^{ \prime})dr^{ \prime}}{|r-r^{ \prime}|} \newline
= \int \frac{1}{ \pi} \frac{e^{-2r^{ \prime}}}{ \sqrt{r^{2}+r^{ \prime 2}-2rr^{ \prime} \cos \theta}}r^{ \prime 2} \sin \theta dr^{ \prime}d \theta d \varphi \\
= \int \frac{2dr^{ \prime}}{ \sqrt{2rr^{ \prime}}}e^{-2r^{ \prime}}r^{ \prime 2}2 \sqrt{ \frac{r^{2}+r^{ \prime 2}}{2rr^{ \prime}}- \cos \theta} \Big|_{0}^{ \pi} \\
=4 \int \frac{e^{-2r^{ \prime}}dr^{ \prime}}{2rr^{ \prime}}r^{ \prime 2}(r+r^{ \prime}-|r-r^{ \prime}|) \\
= \frac{2}{r} \left( \int_{0}^{r}e^{-2r^{ \prime}}dr^{ \prime}r^{ \prime}2r^{ \prime}+ \int_{r}^{ \infty}e^{-2r^{ \prime}}dr^{ \prime}r^{ \prime}2r \right) \\
=-e^{-2r}- \frac{1}{r}e^{-2r}+ \frac{1}{r}
\end{array}
$$
$$
\begin{array}{l}
E_{c} &=\frac{1}{2} \int \frac{1}{ \pi}e^{-2r}r^{2}dr(4 \pi) \left(-e^{-2r}- \frac{1}{r}e^{-2r}+ \frac{1}{r} \right) \\
&=2 \int dre^{-2r}(-r^{2}e^{-2r}-re^{-2r}+r) \\
&=2 \int_{0}^{ \infty}dr \left(-r^{2}e^{-4r}-re^{-4r}+re^{-2r} \right) \\
&=2(- \frac{2}{4^3}- \frac{1}{4^2}+ \frac{1}{2^2}) \\
&=\frac{5}{16}
\end{array}
$$
